(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08272752"],{2017:function(e,t,n){"use strict";n("ed55")},"3e10":function(e,t,n){"use strict";function o(e,t,n,o){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,r=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=a/2-n/2+i,c=r/2-o/2+s,d=window.open(e,t,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=yes, copyhistory=no, width="+n+", height="+o+", top="+c+", left="+l);window.focus&&d.focus()}n.d(t,"a",(function(){return o}))},"8eba":function(e,t,n){"use strict";n("aca4")},"9ed6":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container"},[n("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[n("div",{staticClass:"title-container"},[n("h3",{staticClass:"title tenant"},[e._v(e._s(e.title)+" ")]),n("el-select",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tenant",attrs:{placeholder:"请选择租户"},model:{value:e.loginForm.tenant,callback:function(t){e.$set(e.loginForm,"tenant",t)},expression:"loginForm.tenant"}},e._l(e.tenant.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tips",staticStyle:{"margin-bottom":"20px"},on:{click:function(t){e.loginForm.loginSwitch=!e.loginForm.loginSwitch}}},[n("a",{class:{"is-unactive":!e.loginForm.loginSwitch}},[e._v("用户名登录")]),e._v(" | "),n("a",{class:{"is-unactive":e.loginForm.loginSwitch}},[e._v("手机号登录")])]),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.loginForm.loginSwitch,expression:"loginForm.loginSwitch"}],attrs:{prop:"username"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"user"}})],1),n("el-input",{ref:"username",attrs:{placeholder:"账号",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.loginForm.loginSwitch,expression:"loginForm.loginSwitch"}],attrs:{prop:"password"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"password"}})],1),n("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),n("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[n("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.loginForm.loginSwitch,expression:"!loginForm.loginSwitch"}],attrs:{prop:"phone"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"user"}})],1),n("el-input",{ref:"phone",staticStyle:{width:"69%"},attrs:{placeholder:"手机号",name:"phone",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.phone,callback:function(t){e.$set(e.loginForm,"phone",t)},expression:"loginForm.phone"}}),n("el-button",{attrs:{disabled:!e.smsEnable,type:"info",size:"small"},on:{click:e.sendSms}},[e._v(e._s(e.smsSeconds))])],1),n("el-form-item",{attrs:{prop:"code"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"password"}})],1),n("el-input",{attrs:{placeholder:"验证码",name:"password","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.loginForm.loginSwitch,expression:"loginForm.loginSwitch"}],staticClass:"show-code",on:{click:e.refreshCode}},[n("el-image",{staticStyle:{width:"90px",height:"85%","margin-top":"5px"},attrs:{src:e.codeUrl}})],1)],1),n("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v(" 登 录 ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"tips"},[n("el-divider",[e._v("第三方登录")]),n("ul",{staticStyle:{display:"flex","align-items":"center","flex-wrap":"wrap"}},e._l(e.socials,(function(t,o){return n("li",{key:o,staticStyle:{display:"flex","justify-content":"center","align-items":"center","margin-bottom":"10px"}},[t.icon?n("img",{staticStyle:{height:"15px","margin-right":"5px"},attrs:{src:t.icon}}):e._e(),n("span",{staticStyle:{"line-height":"20px"},on:{click:function(n){return e.oauth2Button(t.type,t.authorizeUri,540)}}},[e._v(e._s(t.title))]),n("el-divider",{attrs:{direction:"vertical"}})],1)})),0)],1)],1)],1)},i=[],s=(n("e18c"),n("1c2e"),n("7ded")),a=n("3e10"),r=n("83d6"),l={name:"Login",data:function(){return{loginForm:{username:"admin",password:"123456",imageKey:Math.random().toString(36).substr(2),code:"",phone:"",tenant:1,loginSwitch:!0,loginType:"password",type:"",socialCode:""},loginRules:{},title:r["title"],codeUrl:"",loading:!1,passwordType:"password",redirect:void 0,smsSeconds:"获取验证码",smsEnable:!0,tenant:{options:[{value:1,label:"租户1 - 不支持修改数据,仅提供预览"},{value:2,label:"租户2 - 定时重置数据库,可修改数据"}]},socials:[]}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},destroyed:function(){window.removeEventListener("storage",this.afterQRScan)},created:function(){this.refreshCode(),window.addEventListener("storage",this.afterQRScan)},methods:{getSocialsData:function(){var e=this;this.loginForm.socialRedirect=window.location.origin+window.location.pathname+"auth-redirect.html",Object(s["e"])({redirect_uri:this.loginForm.socialRedirect,tenant_id:this.loginForm.tenant}).then((function(t){e.socials=t.data}))},sendSms:function(){var e=this;Object(s["d"])({phone:this.loginForm.phone}).then((function(t){if(0===t.code){var n=60;e.smsEnable=!1;var o=setInterval((function(){e.smsSeconds=n--+" 秒可重发",n<=0&&(clearInterval(o),e.smsSeconds=" 获取验证码 ",e.smsEnable=!0)}),1e3);e.$notify({title:"模拟发送",message:t.msg,duration:0})}}))},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},refreshCode:function(){this.loginForm.imageKey=Math.random().toString(36).substr(2),this.codeUrl="/sys/auth/captcha/image?key="+this.loginForm.imageKey},oauth2Button:function(e,t,n){this.loginForm.socialType=e,Object(a["a"])(t,e,n,540)},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$router.push({path:e.redirect||"/"}),e.loading=!1})).catch((function(){e.loading=!1}))}))},afterQRScan:function(e){var t=this;"x-admin-oauth-code"===e.key&&(this.loginForm.socialCode=e.newValue,this.loginForm.loginType="social",this.loading=!0,this.$store.dispatch("user/login",this.loginForm).then((function(){t.$router.push({path:t.redirect||"/"}),t.loading=!1})).catch((function(){t.loading=!1})))}}},c=l,d=(n("2017"),n("8eba"),n("c701")),u=Object(d["a"])(c,o,i,!1,null,"2724869f",null);t["default"]=u.exports},aca4:function(e,t,n){},ed55:function(e,t,n){}}]);